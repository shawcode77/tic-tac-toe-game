<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Toe Game</title>
<style>
/* ---------------- 基础布局 ---------------- */
body {
  font-family: 'Roboto', 'Helvetica Neue', Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  background: #f9fafb; /* 更柔和的浅灰 */
  padding: 20px;
}
h1 {
  margin: 0 0 12px 0;
  font-size: clamp(24px, 6vw, 40px);
  font-weight: 900;
  display: flex;
  gap: 8px;
  user-select: none;
  text-transform: uppercase; /* 英文标题大写 */
}
/* 标题颜色优化为柔和现代色 */
h1 span:nth-child(1){ color:#ff4d4f; }   /* Tic */
h1 span:nth-child(2){ color:#ffa940; }   /* Tac */
h1 span:nth-child(3){ color:#40c057; }   /* Toe */

/* ---------------- 模式按钮 ---------------- */
#modeBtn {
  margin: 12px 0;
  padding: 10px 22px;
  border: none;
  border-radius: 14px;
  background: linear-gradient(135deg,#4dabf7,#1971c2);
  color: white;
  cursor: pointer;
  font-size: 15px;
  font-weight: 600;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: all 0.2s ease;
}
#modeBtn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}

/* ---------------- 得分板 ---------------- */
.scoreboard {
  display: flex;
  justify-content: center;
  gap: 22px;
  margin: 12px 0;
}
.score-card {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 110px;
  padding: 10px 14px;
  border-radius: 12px;
  background: #fff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  font-weight: bold;
  font-size: 17px;
}
.score-card.active {
  box-shadow: 0 5px 14px rgba(0,0,0,0.25);
  transform: scale(1.06);
}
.score-symbol.X { color:#e63946; font-size:19px; }
.score-symbol.O { color:#1d3557; font-size:19px; }
.score-value { min-width: 18px; text-align: right; }

/* ---------------- 状态信息 ---------------- */
#statusMessage {
  margin: 6px 0;
  font-size: 15px;
  color: #555;
  min-height: 1.2em;
}

/* ---------------- 棋盘 ---------------- */
#board {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 6px;
  width: 72vw;
  max-width: 340px;
  aspect-ratio: 1 / 1;
  background: #fff;
  padding: 12px;
  border-radius: 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.18);
  margin-top: 12px;
}
.cell {
  background: #f8f9fa;
  border: 2px solid #333;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(26px, 7vw, 50px);
  font-weight: 800;
  cursor: pointer;
  border-radius: 12px;
  transition: background 0.2s, transform 0.15s;
  user-select: none;
  aspect-ratio: 1 / 1;
}
.cell:hover { background: #e3f2fd; transform: scale(1.06); }

/* 缩放动画 */
@keyframes popIn {
  from { transform: scale(0.3); opacity:0.5; }
  to   { transform: scale(1); opacity:1; }
}

.cell.X { color: #e63946; }
.cell.O { color: #1d3557; }
.win { background: rgba(72, 187, 120,0.4) !important; }

/* ---------------- 游戏信息 ---------------- */
#message {
  margin-top: 14px;
  font-size: clamp(16px, 4.5vw, 24px);
  font-weight: 700;
  text-align: center;
  min-height: 1.2em;
  color: #333;
}

/* ---------------- 重置按钮 ---------------- */
#resetBtn {
  margin-top: 16px;
  padding: 12px 24px;
  font-size: clamp(15px, 4vw, 20px);
  border: none;
  border-radius: 18px;
  background: linear-gradient(135deg,#4dabf7,#1971c2);
  color: #fff;
  cursor: pointer;
  font-weight: 600;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: all 0.2s ease;
}
#resetBtn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}
</style>
</head>
<body>
<h1>
  <span>Tic</span><span>Tac</span><span>Toe</span>
</h1>

<button id="modeBtn">1 Player</button>

<div class="scoreboard">
  <div class="score-card active" data-player="X">
    <div class="score-symbol X">X</div>
    <div class="score-value" id="scoreX">-</div>
  </div>
  <div class="score-card" data-player="O">
    <div class="score-symbol O">O</div>
    <div class="score-value" id="scoreO">-</div>
  </div>
</div>
<div id="statusMessage">Start game or select player</div>

<div id="board"></div>
<div id="message"></div>
<button id="resetBtn">Restart game</button>

<script>
const board = document.getElementById('board');
const message = document.getElementById('message');
const resetBtn = document.getElementById('resetBtn');
const modeBtn = document.getElementById('modeBtn');
const scoreXEl = document.getElementById('scoreX');
const scoreOEl = document.getElementById('scoreO');
const scoreCards = document.querySelectorAll('.score-card');
const statusMessage = document.getElementById('statusMessage');

let currentPlayer = 'X';
let cells = [];
let isVsAI = true;
let humanPlayer = 'X';
let aiPlayer = 'O';
let scores = { X: 0, O: 0 };
let gameActive = false;
let firstMove = true;

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
document.addEventListener('click', () => {
  if (audioCtx.state === 'suspended') audioCtx.resume();
}, { once: true });

function playTone(frequency, type="square", duration=0.2, volume=0.2, delay=0){
  const now = audioCtx.currentTime + delay;
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = type; osc.frequency.setValueAtTime(frequency, now);
  gain.gain.setValueAtTime(volume, now);
  osc.connect(gain); gain.connect(audioCtx.destination);
  osc.start(now); osc.stop(now + duration);
}
function playMoveSound(p){ p==='X' ? playTone(1000) : playTone(750); }
function playWinSound(){ playTone(600,"triangle",0.2,0.3); playTone(800,"triangle",0.2,0.3,0.25); playTone(1000,"triangle",0.3,0.3,0.5); }
function playDrawSound(){ playTone(500,"sine",0.3,0.25); playTone(300,"sine",0.3,0.25,0.3); }

function createBoard() {
  board.innerHTML = '';
  cells = [];
  message.textContent = '';
  message.style.color = '#444';
  message.style.fontStyle = 'normal';
  currentPlayer = 'X';
  gameActive = true;
  firstMove = true;

  for (let i=0; i<9; i++) {
    const cell = document.createElement('button');
    cell.classList.add('cell');
    cell.addEventListener('click', () => handleMove(cell));
    board.appendChild(cell);
    cells.push(cell);
  }

  updateScores();

  if (isVsAI) {
    statusMessage.textContent = "Start game or select player";
    if (aiPlayer==='X') setTimeout(aiMove, 500);
  } else {
    statusMessage.textContent = currentPlayer + " Turn";
    updateTurnUI();
  }
}

function handleMove(cell) {
  if (!gameActive) return;
  if (cell.textContent!=='' || message.textContent!=='') return;

  if (firstMove) firstMove = false;

  cell.textContent = currentPlayer;
  cell.classList.add(currentPlayer);

  cell.style.animation = "none";
  cell.offsetHeight;
  cell.style.animation = "popIn 0.25s ease-out";

  playMoveSound(currentPlayer);

  const winPattern = checkWin(currentPlayer);
  if (winPattern) {
    disableBoard();
    playWinSound();
    scores[currentPlayer] += 1;
    updateScores();
    highlightWin(winPattern);
    gameActive = false;

    message.style.color = currentPlayer==='X' ? '#e63946' : '#1d3557';
    message.style.fontStyle = 'normal';
    message.textContent = currentPlayer + " Wins! 🎉";
    return;
  } else if (cells.every(c=>c.textContent!=='')) {
    playDrawSound();
    gameActive = false;
    message.style.color = '#888';
    message.style.fontStyle = 'italic';
    message.textContent = 'Draw! 🤝';
    return;
  } else {
    currentPlayer = currentPlayer==='X'?'O':'X';
    updateTurnUI();
    if (isVsAI && currentPlayer===aiPlayer && message.textContent==='') {
      setTimeout(aiMove, 500);
    }
  }
}

function aiMove() {
  if (!gameActive) return;
  if (firstMove) firstMove = false;
  const winMove = findBestMove(aiPlayer);
  if (winMove !== null) return handleMove(cells[winMove]);

  const blockMove = findBestMove(humanPlayer);
  if (blockMove !== null) return handleMove(cells[blockMove]);

  const empty = cells.map((c,i)=>c.textContent===''?i:null).filter(i=>i!==null);
  if (empty.length===0) return;
  const choice = empty[Math.floor(Math.random()*empty.length)];
  handleMove(cells[choice]);
}

function findBestMove(player) {
  const winPatterns = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for (let p of winPatterns) {
    const [a,b,c] = p;
    const values = [cells[a].textContent, cells[b].textContent, cells[c].textContent];
    if (values.filter(v=>v===player).length===2 && values.includes('')) {
      return p[values.indexOf('')];
    }
  }
  return null;
}

function checkWin(player) {
  const winPatterns=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for (let p of winPatterns) {
    if (p.every(i=>cells[i].textContent===player)) return p;
  }
  return null;
}

function highlightWin(p){ p.forEach(i=>cells[i].classList.add('win')); }

function disableBoard(){ cells.forEach(c=>c.disabled=true); }

function updateScores() {
  scoreXEl.textContent = scores.X>0 ? scores.X : '-';
  scoreOEl.textContent = scores.O>0 ? scores.O : '-';
}

function updateTurnUI() {
  scoreCards.forEach(c=>c.classList.remove('active'));
  if (gameActive) {
    const currentCard = document.querySelector(`.score-card[data-player="${currentPlayer}"]`);
    currentCard.classList.add('active');
    statusMessage.textContent = currentPlayer + " Turn";
  }
}

resetBtn.addEventListener('click', createBoard);

modeBtn.addEventListener('click', ()=>{
  isVsAI = !isVsAI;
  modeBtn.textContent = isVsAI ? "1 Player" : "2 Players";
  createBoard();
});

scoreCards.forEach(card=>{
  card.addEventListener('click', ()=>{
    if (!isVsAI) return;
    scoreCards.forEach(c=>c.classList.remove('active'));
    card.classList.add('active');
    if (card.dataset.player==='X') {
      humanPlayer = 'X'; aiPlayer='O';
    } else {
      humanPlayer = 'O'; aiPlayer='X';
    }
    createBoard();
  });
});

createBoard();
</script>
</body>
</html>

